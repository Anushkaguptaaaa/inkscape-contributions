#!/usr/bin/make -f
# -*- makefile -*-
# debian/rules  for inkscape derived from a sample 
# provided by Joey Hess via dh_make.

# Uncomment this to turn on verbose mode.
export DH_VERBOSE=1

export DEB_BUILD_MAINT_OPTIONS=hardening=+all

# Drop the --parallel flag as soon as we bump to compat 10
# We can do this once we drop support for Ubuntu Xenial and earlier
%:
	dh $@ \
		--buildsystem cmake \
		--parallel          \
		--with bash-completion,gnome,python2

override_dh_gnome_clean:
	dh_gnome_clean --no-control

# No need for autoreconf in CMake builds
override_dh_autoreconf:

override_dh_auto_configure:
	dh_auto_configure --   \
		-DWITH_DBUS=ON

# Have to use "make check" here, as
# dh_auto_test defaults to using "make test",
# which tries to run the tests without building them
# first.
# TODO: Re-enable this and ensure that rule is
#       run in correct folder
# TODO: The "make test" rule in master should probably
#       have a dependency on the test binaries
override_dh_auto_test:
#	export CTEST_OUTPUT_ON_FAILURE=1
#	make check

# Don't run scour, there is no need for it at all, and the defaults are not
# appropriate for Inkscape's SVGs
# https://bugs.launchpad.net/ubuntu/+source/inkscape/+bug/1638373
override_dh_scour:
