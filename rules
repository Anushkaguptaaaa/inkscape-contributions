#!/usr/bin/make -f
# -*- makefile -*-
# debian/rules  for inkscape derived from a sample 
# provided by Joey Hess via dh_make.

# Uncomment this to turn on verbose mode.
export DH_VERBOSE=1

export DEB_BUILD_MAINT_OPTIONS=hardening=+all

%:
	dh $@ --buildsystem=cmake --with bash-completion,python2 --parallel

override_dh_auto_clean:
	dh_auto_clean --builddirectory=build-default
	dh_auto_clean --builddirectory=build-gtk3
	[ ! -f Makefile ] || $(MAKE) distclean

override_dh_auto_configure:
	dh_auto_configure --builddirectory=build-default -- -DWITH_DBUS=ON -DGMOCK_DIR="/usr/src/gmock"
	dh_auto_configure --builddirectory=build-gtk3    -- -DWITH_DBUS=ON -DGMOCK_DIR="/usr/src/gmock" -DWITH_GTK3_EXPERIMENTAL=ON

override_dh_auto_build:
	dh_auto_build --builddirectory=build-default
	dh_auto_build --builddirectory=build-gtk3

override_dh_auto_test:
	dh_auto_test --builddirectory=build-default
	dh_auto_test --builddirectory=build-gtk3


# Rule for installing files from the build directories to (temporary)
# installation folders.  From there, we can subsequently copy all the files into
# the relevant packages
override_dh_auto_install:
	dh_auto_install --builddirectory=build-default --destdir=debian/tmp/install-default
	dh_auto_install --builddirectory=build-gtk3    --destdir=debian/tmp/install-gtk3
